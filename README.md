# é‡åŒ–äº¤æ˜“ç³»ç»Ÿ

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„é‡åŒ–äº¤æ˜“å›æµ‹ç³»ç»Ÿï¼Œæ”¯æŒç­–ç•¥å¼€å‘ã€å†å²æ•°æ®å›æµ‹ã€å‚æ•°ä¼˜åŒ–ã€é£é™©æ§åˆ¶å’Œå®æ—¶ä¿¡å·ç”Ÿæˆã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **å¤šæ•°æ®æºæ”¯æŒ**: akshareï¼ˆAè‚¡ï¼‰ã€tushareï¼ˆéœ€tokenï¼‰ã€yfinanceï¼ˆç¾è‚¡/æ¸¯è‚¡ç­‰ï¼‰
- âœ… **å¤šç§ç­–ç•¥**: åŒå‡çº¿ã€RSIã€MACDï¼Œæ”¯æŒè‡ªå®šä¹‰ç­–ç•¥
- âœ… **å®Œæ•´å›æµ‹å¼•æ“**: å†å²æ•°æ®å›æµ‹ã€æ€§èƒ½æŒ‡æ ‡è®¡ç®—
- âœ… **å‚æ•°ä¼˜åŒ–**: ç½‘æ ¼æœç´¢è‡ªåŠ¨å¯»æ‰¾æœ€ä¼˜å‚æ•°
- âœ… **é£é™©æ§åˆ¶**: æ­¢æŸã€æ­¢ç›ˆã€ä»“ä½ç®¡ç†
- âœ… **ç­–ç•¥ç»„åˆ**: å¤šç­–ç•¥ç»„åˆï¼Œæé«˜ç¨³å®šæ€§
- âœ… **å®æ—¶ä¿¡å·**: ç”Ÿæˆå®æ—¶äº¤æ˜“ä¿¡å·
- âœ… **Webç•Œé¢**: Streamlitå¯è§†åŒ–ç•Œé¢ï¼Œäº¤äº’å¼æ“ä½œ

### æŠ€æœ¯ç‰¹ç‚¹
- ğŸ—ï¸ **æ¨¡å—åŒ–è®¾è®¡**: æ˜“äºæ‰©å±•å’Œç»´æŠ¤
- ğŸ”Œ **æ’ä»¶åŒ–æ¶æ„**: æ•°æ®æºã€ç­–ç•¥å‡å¯æ’æ‹”
- ğŸ“Š **ä¸°å¯Œå¯è§†åŒ–**: Matplotlibå’ŒPlotlyåŒå¼•æ“
- âš™ï¸ **çµæ´»é…ç½®**: YAMLé…ç½®æ–‡ä»¶ï¼Œæ”¯æŒå¤šç§å‚æ•°ç»„åˆ

## ğŸ“ é¡¹ç›®ç»“æ„

```
lh/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data/              # æ•°æ®æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ base_data_source.py      # æ•°æ®æºåŸºç±»
â”‚   â”‚   â”œâ”€â”€ akshare_data_source.py   # akshareå®ç°
â”‚   â”‚   â”œâ”€â”€ tushare_data_source.py   # tushareå®ç°
â”‚   â”‚   â”œâ”€â”€ yfinance_data_source.py  # yfinanceå®ç°
â”‚   â”‚   â””â”€â”€ data_manager.py          # æ•°æ®ç®¡ç†å™¨
â”‚   â”œâ”€â”€ strategies/        # ç­–ç•¥æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ base_strategy.py         # ç­–ç•¥åŸºç±»
â”‚   â”‚   â”œâ”€â”€ moving_average_strategy.py  # åŒå‡çº¿ç­–ç•¥
â”‚   â”‚   â”œâ”€â”€ rsi_strategy.py         # RSIç­–ç•¥
â”‚   â”‚   â”œâ”€â”€ macd_strategy.py         # MACDç­–ç•¥
â”‚   â”‚   â””â”€â”€ strategy_portfolio.py    # ç­–ç•¥ç»„åˆ
â”‚   â”œâ”€â”€ backtest/          # å›æµ‹æ¨¡å—
â”‚   â”‚   â””â”€â”€ backtest_engine.py       # å›æµ‹å¼•æ“
â”‚   â”œâ”€â”€ risk/              # é£é™©æ§åˆ¶æ¨¡å—
â”‚   â”‚   â””â”€â”€ risk_manager.py          # é£é™©ç®¡ç†å™¨
â”‚   â”œâ”€â”€ optimization/      # å‚æ•°ä¼˜åŒ–æ¨¡å—
â”‚   â”‚   â””â”€â”€ parameter_optimizer.py   # å‚æ•°ä¼˜åŒ–å™¨
â”‚   â”œâ”€â”€ signals/           # å®æ—¶ä¿¡å·æ¨¡å—
â”‚   â”‚   â””â”€â”€ realtime_signal.py       # å®æ—¶ä¿¡å·ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ visualization/     # å¯è§†åŒ–æ¨¡å—
â”‚   â”‚   â””â”€â”€ plotter.py               # å›¾è¡¨ç»˜åˆ¶
â”‚   â””â”€â”€ utils/             # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ config_loader.py         # é…ç½®åŠ è½½
â”‚       â””â”€â”€ logger.py                # æ—¥å¿—å·¥å…·
â”œâ”€â”€ config.yaml            # é…ç½®æ–‡ä»¶
â”œâ”€â”€ main.py                # å‘½ä»¤è¡Œä¸»ç¨‹åº
â”œâ”€â”€ web_app.py             # Webç•Œé¢ï¼ˆStreamlitï¼‰
â”œâ”€â”€ requirements.txt       # ä¾èµ–åŒ…
â””â”€â”€ README.md             # è¯´æ˜æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

**æ³¨æ„**: 
- å¦‚æœä½¿ç”¨tushareï¼Œéœ€è¦ä» [tushare.pro](https://tushare.pro/) è·å–token
- å¦‚æœé‡åˆ°ç½‘ç»œé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨å›½å†…é•œåƒæºï¼š
  ```bash
  pip install -r requirements.txt -i https://pypi.org/simple
  ```

### 2. é…ç½®å‚æ•°

ç¼–è¾‘ `config.yaml` æ–‡ä»¶ï¼Œè®¾ç½®ï¼š
- æ•°æ®æºå’Œè‚¡ç¥¨ä»£ç 
- å›æµ‹æ—¶é—´èŒƒå›´
- ç­–ç•¥å‚æ•°
- é£é™©æ§åˆ¶å‚æ•°ï¼ˆå¯é€‰ï¼‰

### 3. è¿è¡Œæ–¹å¼

#### æ–¹å¼1: å‘½ä»¤è¡Œè¿è¡Œ
```bash
python main.py
```

#### æ–¹å¼2: Webç•Œé¢ï¼ˆæ¨èï¼‰
```bash
streamlit run web_app.py
```
ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ˜¾ç¤ºçš„åœ°å€ï¼ˆé€šå¸¸æ˜¯ http://localhost:8501ï¼‰

## ğŸ“– ä½¿ç”¨è¯´æ˜

### Webç•Œé¢åŠŸèƒ½

1. **å›æµ‹åˆ†æ**
   - é€‰æ‹©æ•°æ®æºã€è‚¡ç¥¨ä»£ç å’Œæ—¶é—´èŒƒå›´
   - é€‰æ‹©ç­–ç•¥ç±»å‹å’Œå‚æ•°
   - å¯ç”¨/ç¦ç”¨é£é™©æ§åˆ¶
   - æŸ¥çœ‹å›æµ‹ç»“æœå’Œå¯è§†åŒ–å›¾è¡¨

2. **å‚æ•°ä¼˜åŒ–**
   - è®¾ç½®å‚æ•°æœç´¢èŒƒå›´
   - è‡ªåŠ¨å¯»æ‰¾æœ€ä¼˜å‚æ•°ç»„åˆ
   - æŸ¥çœ‹Top Nç»“æœå¯¹æ¯”

3. **å®æ—¶ä¿¡å·**
   - è¾“å…¥è‚¡ç¥¨ä»£ç 
   - é€‰æ‹©ç­–ç•¥
   - ç”Ÿæˆå½“å‰äº¤æ˜“ä¿¡å·

4. **ç­–ç•¥ç»„åˆ**
   - ç»„åˆå¤šä¸ªç­–ç•¥
   - è®¾ç½®ç­–ç•¥æƒé‡
   - æé«˜ç­–ç•¥ç¨³å®šæ€§

### é…ç½®æ–‡ä»¶è¯´æ˜

#### æ•°æ®æºé…ç½®
```yaml
data:
  source: "akshare"  # akshare / tushare / yfinance
  symbol: "000001"   # è‚¡ç¥¨ä»£ç 
  start_date: "2023-01-01"
  end_date: "2024-01-01"
  frequency: "daily"
  tushare_token: ""  # tushare tokenï¼ˆå¯é€‰ï¼‰
```

#### é£é™©æ§åˆ¶é…ç½®
```yaml
risk:
  enabled: true
  stop_loss: 0.05      # æ­¢æŸ5%
  take_profit: 0.15    # æ­¢ç›ˆ15%
  max_position: 1.0    # æœ€å¤§ä»“ä½100%
  position_sizing: "fixed"  # fixed / kelly / volatility
```

#### ç­–ç•¥é…ç½®
```yaml
strategy:
  name: "MovingAverage"  # MovingAverage / RSI / MACD
  params:
    short_window: 5
    long_window: 20
```

## ğŸ”§ æ‰©å±•å¼€å‘

### æ·»åŠ æ–°æ•°æ®æº

1. ç»§æ‰¿ `BaseDataSource` ç±»
2. å®ç° `fetch_data()` å’Œ `validate_data()` æ–¹æ³•
3. åœ¨ `DataManager` ä¸­æ³¨å†Œ

```python
from src.data.base_data_source import BaseDataSource

class MyDataSource(BaseDataSource):
    def fetch_data(self, symbol, start_date, end_date, frequency):
        # å®ç°æ•°æ®è·å–é€»è¾‘
        pass
    
    def validate_data(self, data):
        return True

# æ³¨å†Œ
DataManager.register_data_source('my_source', MyDataSource)
```

### æ·»åŠ æ–°ç­–ç•¥

1. ç»§æ‰¿ `BaseStrategy` ç±»
2. å®ç° `generate_signals()` æ–¹æ³•
3. è¿”å›åŒ…å« `signal` åˆ—çš„DataFrame

```python
from src.strategies.base_strategy import BaseStrategy

class MyStrategy(BaseStrategy):
    def generate_signals(self, data):
        # å®ç°ä¿¡å·ç”Ÿæˆé€»è¾‘
        # signal: 1=ä¹°å…¥, -1=å–å‡º, 0=æŒæœ‰
        df['signal'] = ...
        return df[['date', 'signal', ...]]
```

### ä½¿ç”¨é£é™©æ§åˆ¶

```python
from src.risk.risk_manager import RiskManager
from src.backtest.backtest_engine import BacktestEngine

# åˆ›å»ºé£é™©ç®¡ç†å™¨
risk_manager = RiskManager(
    stop_loss=0.05,      # æ­¢æŸ5%
    take_profit=0.15,     # æ­¢ç›ˆ15%
    max_position=0.8     # æœ€å¤§ä»“ä½80%
)

# åœ¨å›æµ‹å¼•æ“ä¸­ä½¿ç”¨
engine = BacktestEngine(
    initial_capital=100000,
    risk_manager=risk_manager
)
```

### å‚æ•°ä¼˜åŒ–

```python
from src.optimization.parameter_optimizer import ParameterOptimizer

optimizer = ParameterOptimizer(initial_capital=100000)
param_grid = {
    'short_window': [5, 10, 15, 20],
    'long_window': [20, 30, 40, 50]
}

result = optimizer.grid_search(
    MovingAverageStrategy,
    data,
    param_grid,
    metric='sharpe_ratio'
)

print(f"æœ€ä¼˜å‚æ•°: {result['best_params']}")
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

ç³»ç»Ÿè®¡ç®—ä»¥ä¸‹æ€§èƒ½æŒ‡æ ‡ï¼š
- **æ€»æ”¶ç›Šç‡**: æ•´ä¸ªå›æµ‹æœŸé—´çš„æ€»æ”¶ç›Š
- **å¹´åŒ–æ”¶ç›Šç‡**: æ¢ç®—ä¸ºå¹´åŒ–æ”¶ç›Š
- **å¤æ™®æ¯”ç‡**: é£é™©è°ƒæ•´åçš„æ”¶ç›ŠæŒ‡æ ‡
- **æœ€å¤§å›æ’¤**: æœ€å¤§äºæŸå¹…åº¦
- **äº¤æ˜“æ¬¡æ•°**: ä¹°å–äº¤æ˜“çš„æ€»æ¬¡æ•°
- **èƒœç‡**: ç›ˆåˆ©äº¤æ˜“å æ¯”ï¼ˆé¢„ç•™ï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä»…ä¾›å­¦ä¹ ç ”ç©¶**: æœ¬ç³»ç»Ÿä»…ç”¨äºå­¦ä¹ å’Œç ”ç©¶ï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®
2. **å›æµ‹å±€é™æ€§**: å›æµ‹ç»“æœä¸ä»£è¡¨æœªæ¥è¡¨ç°ï¼Œå†å²æ•°æ®ä¸ä»£è¡¨æœªæ¥æ”¶ç›Š
3. **å®ç›˜å·®å¼‚**: å®ç›˜äº¤æ˜“éœ€è¦è€ƒè™‘æ›´å¤šå› ç´ ï¼š
   - æ»‘ç‚¹å’Œå†²å‡»æˆæœ¬
   - æµåŠ¨æ€§é™åˆ¶
   - äº¤æ˜“å»¶è¿Ÿ
   - å¸‚åœºæƒ…ç»ªç­‰
4. **æ•°æ®å‡†ç¡®æ€§**: è¯·ç¡®ä¿æ•°æ®æºçš„å‡†ç¡®æ€§å’ŒåŠæ—¶æ€§
5. **é£é™©æç¤º**: æŠ•èµ„æœ‰é£é™©ï¼Œå…¥å¸‚éœ€è°¨æ…

## ğŸ¯ åç»­ä¼˜åŒ–æ–¹å‘

- [ ] æ”¯æŒæ›´å¤šæŠ€æœ¯æŒ‡æ ‡ï¼ˆå¸ƒæ—å¸¦ã€KDJç­‰ï¼‰
- [ ] æœºå™¨å­¦ä¹ ç­–ç•¥ï¼ˆLSTMã€å¼ºåŒ–å­¦ä¹ ç­‰ï¼‰
- [ ] å¤šæ ‡çš„ç»„åˆå›æµ‹
- [ ] æ›´å¤æ‚çš„è®¢å•ç±»å‹ï¼ˆé™ä»·å•ã€æ­¢æŸå•ç­‰ï¼‰
- [ ] å®æ—¶æ•°æ®æ¨é€
- [ ] æ•°æ®åº“å­˜å‚¨å†å²æ•°æ®
- [ ] ç­–ç•¥å›æµ‹æŠ¥å‘Šç”Ÿæˆ
- [ ] æ›´å¤šå¯è§†åŒ–å›¾è¡¨

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.0 (å½“å‰ç‰ˆæœ¬)
- âœ… æ·»åŠ tushareå’Œyfinanceæ•°æ®æº
- âœ… å®ç°é£é™©æ§åˆ¶æ¨¡å—ï¼ˆæ­¢æŸã€æ­¢ç›ˆã€ä»“ä½ç®¡ç†ï¼‰
- âœ… å®ç°å‚æ•°ä¼˜åŒ–åŠŸèƒ½ï¼ˆç½‘æ ¼æœç´¢ï¼‰
- âœ… æ·»åŠ RSIå’ŒMACDç­–ç•¥
- âœ… å®ç°ç­–ç•¥ç»„åˆåŠŸèƒ½
- âœ… æ·»åŠ å®æ—¶ä¿¡å·ç”Ÿæˆ
- âœ… åˆ›å»ºStreamlit Webç•Œé¢

### v1.0 (MVPç‰ˆæœ¬)
- âœ… åŸºç¡€æ•°æ®è·å–ï¼ˆakshareï¼‰
- âœ… åŒå‡çº¿ç­–ç•¥
- âœ… åŸºç¡€å›æµ‹å¼•æ“
- âœ… æ€§èƒ½æŒ‡æ ‡è®¡ç®—
- âœ… å¯è§†åŒ–å±•ç¤º

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

---

**å…è´£å£°æ˜**: æœ¬ç³»ç»Ÿä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œä¸æ„æˆä»»ä½•æŠ•èµ„å»ºè®®ã€‚ä½¿ç”¨æœ¬ç³»ç»Ÿè¿›è¡Œå®ç›˜äº¤æ˜“çš„é£é™©ç”±ç”¨æˆ·è‡ªè¡Œæ‰¿æ‹…ã€‚
